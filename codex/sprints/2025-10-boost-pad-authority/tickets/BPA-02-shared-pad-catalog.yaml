title: "[rlcoach] Introduce map-aware boost pad catalog shared by Rust and Python"
type: feature
priority: P0
branch: "feature/bpa-02-pad-catalog"
repo:
  url: https://github.com/treygoff/rlcoach
  root: .
  paths_in_scope:
    - schemas/**
    - parsers/rlreplay_rust/build.rs
    - parsers/rlreplay_rust/src/pads/**
    - src/rlcoach/field_constants.py
    - scripts/**
  paths_out_of_scope:
    - src/rlcoach/events.py
    - src/rlcoach/normalize.py
context:
  stack: {lang: Rust, runtime: Python 3.10}
  versions: {rust: "1.75+", python: "3.10"}
  style_guides: ["codex/docs/gpt5-codex-ticketing-guide.md", "codex/docs/gpt5-prompting-best-practices-guide.md"]
  related_issues: ["codex/Plans/1015_boost_pickup_rewrite_followup_plan.md", "codex/sprints/2025-10-boost-pad-authority/tickets/BPA-01-telemetry-ground-truth.yaml"]
problem_statement: >
  The parser currently relies on a single hard-coded pad table that only matches standard Soccar arenas. We need a
  canonical, map-keyed boost pad catalog consumed by both Rust and Python so pad assignments remain accurate across
  arenas and stay synchronized over time.
non_goals:
  - Do not alter pad attribution logic; implement only the shared metadata source.
  - Do not import external dependencies such as serde_yaml or complex build tooling.
constraints:
  - Define a JSON schema under `schemas/` with explicit tolerances, pad types, and map identifiers.
  - Provide code generation or loading paths for both Rust and Python that fail fast when a map is missing.
  - Keep generated Rust code free of heap allocations during lookup; prefer static arrays.
artifacts_expected:
  output_mode: diff
  pr_title_template: "[meta] Add shared boost pad catalog"
  pr_body_sections: ["Context", "Implementation", "Tests", "Risks", "Follow-ups"]
  decision_log: true
acceptance_criteria:
  - [ ] Create `schemas/boost_pads.json` (or similar) with pad coordinates, pad sizes, radii, and snap tolerances keyed by canonical map names.
  - [ ] Add schema validation (JSON Schema or pydantic-style) plus documentation in `schemas/README.md`.
  - [ ] Update Rust build step to transform the JSON into `BOOST_PAD_DEFS` (or equivalent) with compile-time validation.
  - [ ] Update `src/rlcoach/field_constants.py` to load the same JSON, exposing a map-aware interface while keeping cached access.
  - [ ] Add automated checks (unit test or script) ensuring Rust and Python tables hash to the same signature.
verification:
  repro_steps: |
    # Validate schema and code generation
    python scripts/validate_boost_pad_schema.py schemas/boost_pads.json
  checks:
    - cmd: "cargo test -p rlreplay_rust pads::tests::pad_catalog_smoke"
    - cmd: "pytest tests/test_field_constants.py::test_boost_pad_catalog_sync -q"
workflow_expectations:
  - plan-first
  - implement
  - self-check
  - emit_patch
  - run_verification
  - summarize
codex:
  approvals: all
  sandbox: workspace-write
  web_search: false
  progress: brief
  review:
    ask_for_diff_format: unified
  agents_md: true
